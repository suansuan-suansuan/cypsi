<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cy.psi.dao.OutwarehouseDao">

    <resultMap type="com.cy.psi.entity.SaleDelivery" id="SaleDeliveryMap">
        <id property="deliveryOrderId" column="delivery_order_id" jdbcType="VARCHAR"/>
        <result property="deliveryOrderTime" column="delivery_order_time" jdbcType="TIMESTAMP"/>
        <result property="customer" column="customer" jdbcType="VARCHAR"/>
        <result property="salesmen" column="salesmen" jdbcType="VARCHAR"/>
        <result property="receivables" column="receivables" jdbcType="NUMERIC"/>
        <result property="remarks" column="remarks" jdbcType="VARCHAR"/>
        <result property="approver" column="approver" jdbcType="VARCHAR"/>
        <result property="foundTime" column="found_time" jdbcType="TIMESTAMP"/>
        <result property="updateTime" column="update_time" jdbcType="TIMESTAMP"/>
        <result property="approvalTime" column="approval_time" jdbcType="TIMESTAMP"/>
        <result property="approvalState" column="approval_state" jdbcType="INTEGER"/>
        <result property="deliveryState" column="delivery_state" jdbcType="INTEGER"/>
        <result property="orderState" column="order_state" jdbcType="INTEGER"/>
        <result property="saleOrderId" column="sale_order_Id" jdbcType="VARCHAR"/>
    </resultMap>

    <!--连查询出库单 -->
    <select id="selectOutwarehouse" resultMap="SaleDeliveryMap">
     select * from cypsi.sale_delivery
    </select>

    <!--高级查询-->
    <select id="selectBylikeOutwarehouse" resultMap="SaleDeliveryMap">
        select * from cypsi.sale_delivery
        <where>
            <if test="Starttime!=null and Endtime!=null">
                and delivery_order_time between #{Starttime} and #{Endtime}
            </if>
<!--            <if test="documentmaker!=null and documentmaker!=''">-->
<!--                and a.documentMaker like concat('%',#{documentmaker},'%')-->
<!--            </if>-->
            <if test="remarks!=null || remarks!=''">
                and remarks like concat('%',#{remarks},'%')
            </if>
        </where>
    </select>


    <!--审核  出库单-->
    <update id="OutwarehouseAudit" parameterType="com.cy.psi.entity.SaleDelivery">
        update cypsi.sale_delivery set approval_state=#{approvalState} where delivery_order_id=#{deliveryOrderId}
     </update>

    <!--通过主键删除-->
    <delete id="deleteById">
        delete from cypsi.sale_delivery where delivery_order_id = #{deliveryOrderId}
    </delete>

</mapper>

